# dbt Learning Project

## æ¦‚è¦
å®Ÿå‹™ã§ä¿å®ˆã—ã¦ã„ãŸ300è¡Œã®SQLã‚’ã€dbtã‚’ç”¨ã„ã¦12ãƒ¢ãƒ‡ãƒ«ã«å†æ§‹ç¯‰ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒ‡ãƒ¼ã‚¿ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹**: BigQuery
- **å¤‰æ›ãƒ„ãƒ¼ãƒ«**: dbt 1.11.0
- **CI/CD**: GitHub Actions
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: dbt docs + GitHub Pages
- **å“è³ªä¿è¨¼**: dbt test (27ãƒ†ã‚¹ãƒˆå®Ÿè£…)

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 
```
dbt_learning/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ staging/          # ç”Ÿãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢
â”‚   â”‚   â””â”€â”€ stg_sales.sql (incremental)
â”‚   â”œâ”€â”€ intermediate/     # å„ç²’åº¦ãƒ»å„åˆ‡ã‚Šå£ã§ã®é›†è¨ˆ
â”‚   â”‚   â”œâ”€â”€ int_sales_by_year.sql
â”‚   â”‚   â”œâ”€â”€ int_sales_by_month.sql
â”‚   â”‚   â”œâ”€â”€ int_sales_by_week.sql
â”‚   â”‚   â”œâ”€â”€ int_sales_by_day.sql
â”‚   â”‚   â”œâ”€â”€ int_sales_by_channel.sql
â”‚   â”‚   â”œâ”€â”€ int_sales_by_category.sql
â”‚   â”‚   â””â”€â”€ int_sales_by_segment.sql
â”‚   â””â”€â”€ marts/            # æœ€çµ‚æˆæœç‰©
â”‚       â””â”€â”€ fct_sales_multi_grain.sql
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ generic/          # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆ
â”‚       â”œâ”€â”€ test_valid_date_range.sql
â”‚       â”œâ”€â”€ test_positive_values.sql
â”‚       â””â”€â”€ test_valid_values_list.sql
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â””â”€â”€ dbt_ci.yml    # CI/CDè¨­å®š
```

## æˆæœ
| é …ç›® | Before | After | åŠ¹æœ |
|------|--------|-------|------|
| å‡¦ç†æ™‚é–“ | 2æ™‚é–“ | 6åˆ†ï¼ˆ2å›ç›®ä»¥é™ï¼‰ | 96%å‰Šæ¸› |
| ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€  | 1ãƒ•ã‚¡ã‚¤ãƒ«300è¡Œ | 12ãƒ¢ãƒ‡ãƒ«ï¼ˆå¹³å‡25è¡Œï¼‰ | ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ– |
| ãƒ†ã‚¹ãƒˆ | æ‰‹å‹•ãƒ†ã‚¹ãƒˆï¼ˆ1æ—¥ï¼‰ | 27ãƒ†ã‚¹ãƒˆè‡ªå‹•å®Ÿè¡Œï¼ˆ5åˆ†ï¼‰ | 95%å‰Šæ¸› |
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | Excelæ‰‹å‹•æ›´æ–°ï¼ˆåŠæ—¥ï¼‰ | è‡ªå‹•ç”Ÿæˆï¼ˆ0åˆ†ï¼‰ | 100%å‰Šæ¸› |
| å¤‰æ›´æ™‚ã®å½±éŸ¿ç¢ºèª | ç›®è¦–ç¢ºèªï¼ˆ3æ—¥ï¼‰ | Lineage Graphï¼ˆ5åˆ†ï¼‰ | 99%å‰Šæ¸› |
| æ–°ãƒ¡ãƒ³ãƒãƒ¼å¼•ãç¶™ã | 1é€±é–“ | 5åˆ†ï¼ˆLineage Graphèª¬æ˜ï¼‰ | 99%å‰Šæ¸› |

## dbtãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
ğŸ“š **å…¬é–‹URL**: https://sato1046.github.io/docs/dbt/

Lineage Graphã€ãƒ†ã‚¹ãƒˆçµæœã€ãƒ¢ãƒ‡ãƒ«è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™ã€‚

## é–¢é€£è¨˜äº‹
ğŸ“ **[å®Ÿå‹™SQLã‚’dbtåŒ–ã—ãŸ10æ—¥é–“ - ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒèªã‚‹ã€ãƒ“ã‚¸ãƒã‚¹è¦–ç‚¹ã‚’å¤±ã‚ãªã„æŠ€è¡“ç¿’å¾—æ³•](https://qiita.com/sato1046/items/ccca56cae5f6318f97db)**

10æ—¥é–“ã®å­¦ç¿’ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã€ã¤ã¾ã¥ã„ãŸç‚¹ã¨è§£æ±ºæ–¹æ³•ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªå…¬é–‹æ–¹æ³•ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶
- Python 3.11ä»¥ä¸Š
- GCPã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- BigQueryãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
# dbt-bigqueryã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install dbt-bigquery==1.10.2

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/sato1046/sato1046.github.io.git
cd sato1046.github.io/dbt_learning

# profiles.ymlã®è¨­å®šï¼ˆ~/.dbt/profiles.ymlï¼‰
# [è¨­å®šä¾‹ã¯çœç•¥]
```

### å®Ÿè¡Œ
```bash
# ãƒ¢ãƒ‡ãƒ«ã®ãƒ“ãƒ«ãƒ‰
dbt run

# ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
dbt test

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç”Ÿæˆ
dbt docs generate
dbt docs serve
```

## ç’°å¢ƒæ§‹æˆ
- **dev**: é–‹ç™ºç’°å¢ƒï¼ˆå€‹äººä½œæ¥­ï¼‰
- **stg**: ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒï¼ˆãƒãƒ¼ãƒ å…±æœ‰ï¼‰
- **prd**: æœ¬ç•ªç’°å¢ƒï¼ˆæœ€é«˜å“è³ªã®ã¿ï¼‰

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
MIT License

## ä½œæˆè€…
[@sato1046](https://github.com/sato1046)

